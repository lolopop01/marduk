<?xml version="1.0" encoding="UTF-8"?>
<idea-plugin>
    <id>com.marduk.lsp</id>
    <name>Marduk Markup Language (.mkml)</name>
    <version>1.0.1</version>
    <vendor url="https://github.com/your-org/marduk">marduk</vendor>

    <description><![CDATA[
        <p>Full language support for <b>.mkml</b> (Marduk Markup Language) — the declarative UI
        description language for the <a href="https://github.com/your-org/marduk">Marduk</a>
        GPU-accelerated UI framework.</p>

        <h3>Features</h3>
        <ul>
            <li><b>Syntax highlighting</b> — keywords, property keys, strings, color literals,
                numbers, comments</li>
            <li><b>Diagnostics</b> — real-time parse errors from the language server</li>
            <li><b>Completions</b> — widget names, property keys, enum values, color literals</li>
            <li><b>Hover docs</b> — inline documentation for every widget and property</li>
        </ul>

        <h3>Requirements</h3>
        <p>The <code>marduk-lsp</code> binary must be reachable. The plugin looks for it at
        <code>target/release/marduk-lsp</code> or <code>target/debug/marduk-lsp</code> inside
        the open project, and falls back to <code>cargo run -p marduk-lsp</code> automatically.</p>
    ]]></description>

    <!-- Required by all IntelliJ Platform plugins. -->
    <depends>com.intellij.modules.platform</depends>
    <!-- Built-in LSP client — available in IntelliJ IDEA Ultimate, RustRover,
         WebStorm, and other paid JetBrains IDEs since 2023.2.             -->
    <depends>com.intellij.modules.lsp</depends>

    <extensions defaultExtensionNs="com.intellij">

        <!-- Register .mkml as a known file type. -->
        <fileType
            name="Marduk Markup Language"
            implementationClass="com.marduk.lsp.MardukFileType"
            fieldName="INSTANCE"
            language="Marduk"
            extensions="mkml"/>

        <!-- Syntax highlighting (lexer-based; semantic highlighting via LSP). -->
        <lang.syntaxHighlighter
            language="Marduk"
            implementationClass="com.marduk.lsp.MardukSyntaxHighlighter"/>

        <!-- Hook into the built-in LSP client. -->
        <platform.lsp.serverSupportProvider
            implementation="com.marduk.lsp.MardukLspServerSupportProvider"/>

    </extensions>
</idea-plugin>
